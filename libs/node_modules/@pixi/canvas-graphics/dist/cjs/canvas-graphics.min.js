/*!
 * @pixi/canvas-graphics - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/canvas-graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var canvasRenderer,core=require("@pixi/core"),math=require("@pixi/math"),canvasRenderer$1=require("@pixi/canvas-renderer"),graphics=require("@pixi/graphics"),CanvasGraphicsRenderer=function(){function e(e){this.renderer=e,this._svgMatrix=null,this._tempMatrix=new math.Matrix}return e.prototype._calcCanvasStyle=function(e,t){var r;return e.texture&&e.texture.baseTexture!==core.Texture.WHITE.baseTexture?e.texture.valid?(r=canvasRenderer$1.canvasUtils.getTintedPattern(e.texture,t),this.setPatternTransform(r,e.matrix||math.Matrix.IDENTITY)):r="#808080":r="#"+("00000"+(0|t).toString(16)).substr(-6),r},e.prototype.render=function(e){var t=this.renderer,r=t.context,a=e.worldAlpha,i=e.transform.worldTransform;t.setContextTransform(i),t.setBlendMode(e.blendMode);for(var s,l,o=e.geometry.graphicsData,n=(e.tint>>16&255)/255,h=(e.tint>>8&255)/255,v=(255&e.tint)/255,p=0;p<o.length;p++){var c=o[p],d=c.shape,g=c.fillStyle,x=c.lineStyle,f=0|c.fillStyle.color,u=0|c.lineStyle.color;if(c.matrix&&t.setContextTransform(i.copyTo(this._tempMatrix).append(c.matrix)),g.visible){var m=((f>>16&255)/255*n*255<<16)+((f>>8&255)/255*h*255<<8)+(255&f)/255*v*255;s=this._calcCanvasStyle(g,m)}if(x.visible){var T=((u>>16&255)/255*n*255<<16)+((u>>8&255)/255*h*255<<8)+(255&u)/255*v*255;l=this._calcCanvasStyle(x,T)}if(r.lineWidth=x.width,r.lineCap=x.cap,r.lineJoin=x.join,r.miterLimit=x.miterLimit,c.type===math.SHAPES.POLY){r.beginPath();var y=(w=d).points,b=c.holes,M=void 0,S=void 0,C=void 0,_=void 0;r.moveTo(y[0],y[1]);for(var P=2;P<y.length;P+=2)r.lineTo(y[P],y[P+1]);if(w.closeStroke&&r.closePath(),b.length>0){M=0,C=y[0],_=y[1];for(P=2;P+2<y.length;P+=2)M+=(y[P]-C)*(y[P+3]-_)-(y[P+2]-C)*(y[P+1]-_);for(var R=0;R<b.length;R++)if(y=b[R].shape.points){S=0,C=y[0],_=y[1];for(P=2;P+2<y.length;P+=2)S+=(y[P]-C)*(y[P+3]-_)-(y[P+2]-C)*(y[P+1]-_);if(S*M<0){r.moveTo(y[0],y[1]);for(P=2;P<y.length;P+=2)r.lineTo(y[P],y[P+1])}else{r.moveTo(y[y.length-2],y[y.length-1]);for(P=y.length-4;P>=0;P-=2)r.lineTo(y[P],y[P+1])}b[R].shape.closeStroke&&r.closePath()}}g.visible&&(r.globalAlpha=g.alpha*a,r.fillStyle=s,r.fill()),x.visible&&(r.globalAlpha=x.alpha*a,r.strokeStyle=l,r.stroke())}else if(c.type===math.SHAPES.RECT){var w=d;g.visible&&(r.globalAlpha=g.alpha*a,r.fillStyle=s,r.fillRect(w.x,w.y,w.width,w.height)),x.visible&&(r.globalAlpha=x.alpha*a,r.strokeStyle=l,r.strokeRect(w.x,w.y,w.width,w.height))}else if(c.type===math.SHAPES.CIRC){w=d;r.beginPath(),r.arc(w.x,w.y,w.radius,0,2*Math.PI),r.closePath(),g.visible&&(r.globalAlpha=g.alpha*a,r.fillStyle=s,r.fill()),x.visible&&(r.globalAlpha=x.alpha*a,r.strokeStyle=l,r.stroke())}else if(c.type===math.SHAPES.ELIP){var A=2*(w=d).width,k=2*w.height,E=w.x-A/2,G=w.y-k/2;r.beginPath();var q=A/2*.5522848,H=k/2*.5522848,I=E+A,L=G+k,z=E+A/2,D=G+k/2;r.moveTo(E,D),r.bezierCurveTo(E,D-H,z-q,G,z,G),r.bezierCurveTo(z+q,G,I,D-H,I,D),r.bezierCurveTo(I,D+H,z+q,L,z,L),r.bezierCurveTo(z-q,L,E,D+H,E,D),r.closePath(),g.visible&&(r.globalAlpha=g.alpha*a,r.fillStyle=s,r.fill()),x.visible&&(r.globalAlpha=x.alpha*a,r.strokeStyle=l,r.stroke())}else if(c.type===math.SHAPES.RREC){var $=(w=d).x,j=w.y,B=w.width,N=w.height,O=w.radius,V=Math.min(B,N)/2|0;O=O>V?V:O,r.beginPath(),r.moveTo($,j+O),r.lineTo($,j+N-O),r.quadraticCurveTo($,j+N,$+O,j+N),r.lineTo($+B-O,j+N),r.quadraticCurveTo($+B,j+N,$+B,j+N-O),r.lineTo($+B,j+O),r.quadraticCurveTo($+B,j,$+B-O,j),r.lineTo($+O,j),r.quadraticCurveTo($,j,$,j+O),r.closePath(),g.visible&&(r.globalAlpha=g.alpha*a,r.fillStyle=s,r.fill()),x.visible&&(r.globalAlpha=x.alpha*a,r.strokeStyle=l,r.stroke())}}},e.prototype.setPatternTransform=function(e,t){if(!1!==this._svgMatrix){if(!this._svgMatrix){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r&&r.createSVGMatrix&&(this._svgMatrix=r.createSVGMatrix()),!this._svgMatrix||!e.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=t.a,this._svgMatrix.b=t.b,this._svgMatrix.c=t.c,this._svgMatrix.d=t.d,this._svgMatrix.e=t.tx,this._svgMatrix.f=t.ty,e.setTransform(this._svgMatrix.inverse())}},e.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},e}(),tempMatrix=new math.Matrix;graphics.Graphics.prototype.generateCanvasTexture=function(e,t){void 0===t&&(t=1);var r=this.getLocalBounds(),a=core.RenderTexture.create({width:r.width,height:r.height,scaleMode:e,resolution:t});canvasRenderer||(canvasRenderer=new canvasRenderer$1.CanvasRenderer),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(tempMatrix),tempMatrix.invert(),tempMatrix.tx-=r.x,tempMatrix.ty-=r.y,canvasRenderer.render(this,{renderTexture:a,clear:!0,transform:tempMatrix});var i=core.Texture.from(a.baseTexture._canvasRenderTarget.canvas,{scaleMode:e});return i.baseTexture.setResolution(t),i},graphics.Graphics.prototype.cachedGraphicsData=[],graphics.Graphics.prototype._renderCanvas=function(e){!0!==this.isMask&&(this.finishPoly(),e.plugins.graphics.render(this))},exports.CanvasGraphicsRenderer=CanvasGraphicsRenderer;
//# sourceMappingURL=canvas-graphics.min.js.map
