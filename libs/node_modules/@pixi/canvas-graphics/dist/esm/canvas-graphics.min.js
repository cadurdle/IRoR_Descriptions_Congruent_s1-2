/*!
 * @pixi/canvas-graphics - v6.0.4
 * Compiled Tue, 11 May 2021 18:00:23 UTC
 *
 * @pixi/canvas-graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
import{Texture as e,RenderTexture as t}from"@pixi/core";import{Matrix as i,SHAPES as r}from"@pixi/math";import{canvasUtils as a,CanvasRenderer as l}from"@pixi/canvas-renderer";import{Graphics as o}from"@pixi/graphics";var s,n=function(){function t(e){this.renderer=e,this._svgMatrix=null,this._tempMatrix=new i}return t.prototype._calcCanvasStyle=function(t,r){var l;return t.texture&&t.texture.baseTexture!==e.WHITE.baseTexture?t.texture.valid?(l=a.getTintedPattern(t.texture,r),this.setPatternTransform(l,t.matrix||i.IDENTITY)):l="#808080":l="#"+("00000"+(0|r).toString(16)).substr(-6),l},t.prototype.render=function(e){var t=this.renderer,i=t.context,a=e.worldAlpha,l=e.transform.worldTransform;t.setContextTransform(l),t.setBlendMode(e.blendMode);for(var o,s,n=e.geometry.graphicsData,h=(e.tint>>16&255)/255,v=(e.tint>>8&255)/255,p=(255&e.tint)/255,f=0;f<n.length;f++){var c=n[f],g=c.shape,d=c.fillStyle,x=c.lineStyle,u=0|c.fillStyle.color,T=0|c.lineStyle.color;if(c.matrix&&t.setContextTransform(l.copyTo(this._tempMatrix).append(c.matrix)),d.visible){var m=((u>>16&255)/255*h*255<<16)+((u>>8&255)/255*v*255<<8)+(255&u)/255*p*255;o=this._calcCanvasStyle(d,m)}if(x.visible){var y=((T>>16&255)/255*h*255<<16)+((T>>8&255)/255*v*255<<8)+(255&T)/255*p*255;s=this._calcCanvasStyle(x,y)}if(i.lineWidth=x.width,i.lineCap=x.cap,i.lineJoin=x.join,i.miterLimit=x.miterLimit,c.type===r.POLY){i.beginPath();var b=(A=g).points,M=c.holes,S=void 0,_=void 0,C=void 0,w=void 0;i.moveTo(b[0],b[1]);for(var P=2;P<b.length;P+=2)i.lineTo(b[P],b[P+1]);if(A.closeStroke&&i.closePath(),M.length>0){S=0,C=b[0],w=b[1];for(P=2;P+2<b.length;P+=2)S+=(b[P]-C)*(b[P+3]-w)-(b[P+2]-C)*(b[P+1]-w);for(var k=0;k<M.length;k++)if(b=M[k].shape.points){_=0,C=b[0],w=b[1];for(P=2;P+2<b.length;P+=2)_+=(b[P]-C)*(b[P+3]-w)-(b[P+2]-C)*(b[P+1]-w);if(_*S<0){i.moveTo(b[0],b[1]);for(P=2;P<b.length;P+=2)i.lineTo(b[P],b[P+1])}else{i.moveTo(b[b.length-2],b[b.length-1]);for(P=b.length-4;P>=0;P-=2)i.lineTo(b[P],b[P+1])}M[k].shape.closeStroke&&i.closePath()}}d.visible&&(i.globalAlpha=d.alpha*a,i.fillStyle=o,i.fill()),x.visible&&(i.globalAlpha=x.alpha*a,i.strokeStyle=s,i.stroke())}else if(c.type===r.RECT){var A=g;d.visible&&(i.globalAlpha=d.alpha*a,i.fillStyle=o,i.fillRect(A.x,A.y,A.width,A.height)),x.visible&&(i.globalAlpha=x.alpha*a,i.strokeStyle=s,i.strokeRect(A.x,A.y,A.width,A.height))}else if(c.type===r.CIRC){A=g;i.beginPath(),i.arc(A.x,A.y,A.radius,0,2*Math.PI),i.closePath(),d.visible&&(i.globalAlpha=d.alpha*a,i.fillStyle=o,i.fill()),x.visible&&(i.globalAlpha=x.alpha*a,i.strokeStyle=s,i.stroke())}else if(c.type===r.ELIP){var R=2*(A=g).width,E=2*A.height,I=A.x-R/2,L=A.y-E/2;i.beginPath();var q=R/2*.5522848,z=E/2*.5522848,D=I+R,G=L+E,B=I+R/2,N=L+E/2;i.moveTo(I,N),i.bezierCurveTo(I,N-z,B-q,L,B,L),i.bezierCurveTo(B+q,L,D,N-z,D,N),i.bezierCurveTo(D,N+z,B+q,G,B,G),i.bezierCurveTo(B-q,G,I,N+z,I,N),i.closePath(),d.visible&&(i.globalAlpha=d.alpha*a,i.fillStyle=o,i.fill()),x.visible&&(i.globalAlpha=x.alpha*a,i.strokeStyle=s,i.stroke())}else if(c.type===r.RREC){var V=(A=g).x,W=A.y,Y=A.width,j=A.height,H=A.radius,J=Math.min(Y,j)/2|0;H=H>J?J:H,i.beginPath(),i.moveTo(V,W+H),i.lineTo(V,W+j-H),i.quadraticCurveTo(V,W+j,V+H,W+j),i.lineTo(V+Y-H,W+j),i.quadraticCurveTo(V+Y,W+j,V+Y,W+j-H),i.lineTo(V+Y,W+H),i.quadraticCurveTo(V+Y,W,V+Y-H,W),i.lineTo(V+H,W),i.quadraticCurveTo(V,W,V,W+H),i.closePath(),d.visible&&(i.globalAlpha=d.alpha*a,i.fillStyle=o,i.fill()),x.visible&&(i.globalAlpha=x.alpha*a,i.strokeStyle=s,i.stroke())}}},t.prototype.setPatternTransform=function(e,t){if(!1!==this._svgMatrix){if(!this._svgMatrix){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");if(i&&i.createSVGMatrix&&(this._svgMatrix=i.createSVGMatrix()),!this._svgMatrix||!e.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=t.a,this._svgMatrix.b=t.b,this._svgMatrix.c=t.c,this._svgMatrix.d=t.d,this._svgMatrix.e=t.tx,this._svgMatrix.f=t.ty,e.setTransform(this._svgMatrix.inverse())}},t.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},t}(),h=new i;o.prototype.generateCanvasTexture=function(i,r){void 0===r&&(r=1);var a=this.getLocalBounds(),o=t.create({width:a.width,height:a.height,scaleMode:i,resolution:r});s||(s=new l),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(h),h.invert(),h.tx-=a.x,h.ty-=a.y,s.render(this,{renderTexture:o,clear:!0,transform:h});var n=e.from(o.baseTexture._canvasRenderTarget.canvas,{scaleMode:i});return n.baseTexture.setResolution(r),n},o.prototype.cachedGraphicsData=[],o.prototype._renderCanvas=function(e){!0!==this.isMask&&(this.finishPoly(),e.plugins.graphics.render(this))};export{n as CanvasGraphicsRenderer};
//# sourceMappingURL=canvas-graphics.min.js.map
